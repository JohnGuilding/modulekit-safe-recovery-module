// SPDX-License-Identifier: MIT
pragma solidity ^0.8.21;

import { IKernel, IKernelFactory } from "../kernel-base/IKernel.sol";

function deployAccountSingleton(address entrypoint) returns (IKernel accountSingleton) {
    bytes memory accountSingletonArgs = abi.encode(entrypoint);
    bytes memory accountSingletonBytecode = abi.encodePacked(KERNEL_BYTECODE, accountSingletonArgs);
    address _accountSingleton;
    assembly {
        _accountSingleton :=
            create(0, add(accountSingletonBytecode, 0x20), mload(accountSingletonBytecode))
    }
    accountSingleton = IKernel(_accountSingleton);
}

bytes constant KERNEL_BYTECODE =
    hex"61014034620001b057601f62001f9738819003918201601f19168301916001600160401b03831184841017620001b557808492602094604052833981010312620001b057516001600160a01b0381168103620001b057306080524660a05260a062000069620001cb565b600681526005602082016512d95c9b995b60d21b815260206200008b620001cb565b838152019264302e322e3160d81b845251902091208160c0528060e052604051917f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f83526020830152604082015246606082015230608082015220906101009182526101209081527f439ffe7df606b78489639bc0b827913bd09e1246fa6802968a5b3694c53e0dd96a010000000000000000000080600160f01b031982541617905560405190611dab9283620001ec8439608051836118f4015260a05183611917015260c05183611989015260e051836119af015251826118d301525181818161048a0152818161064c015281816108a501528181610a3001528181610b5701528181610d5101528181610e7201528181610f730152818161109d01526112ed0152f35b600080fd5b634e487b7160e01b600052604160045260246000fd5b60408051919082016001600160401b03811183821017620001b55760405256fe60806040526004361015610015575b3661108057005b60003560e01c806306fdde03146101655780630b3dc35414610160578063150b7a021461015b5780631626ba7e1461015657806329f8b174146101515780633659cfe61461014c5780633a871cdd146101475780633e1b08121461014257806351166ba01461013d578063519454471461013857806354fd4d501461013357806355b14f501461012e57806357b750471461012957806384b0196e1461012457806388e7fd061461011f578063b0d691fe1461011a578063bc197c8114610115578063d087d28814610110578063d1f578941461010b578063d5416221146101065763f23a6e610361000e57610fee565b610f5c565b610ebe565b610e3f565b610db0565b610d3b565b610d06565b610c5e565b610c27565b610b41565b610ae9565b6109e9565b610920565b61085c565b610732565b610628565b610415565b61039d565b610343565b6102c4565b610290565b600091031261017557565b600080fd5b634e487b7160e01b600052604160045260246000fd5b6001600160401b0381116101a357604052565b61017a565b608081019081106001600160401b038211176101a357604052565b604081019081106001600160401b038211176101a357604052565b90601f801991011681019081106001600160401b038211176101a357604052565b6040519061020c826101a8565b565b6040519061016082018281106001600160401b038211176101a357604052565b6040519061023b826101c3565b600682526512d95c9b995b60d21b6020830152565b919082519283825260005b84811061027c575050826000602080949584010152601f8019910116010190565b60208183018101518483018201520161025b565b34610175576000366003190112610175576102c06102ac61022e565b604051918291602083526020830190610250565b0390f35b34610175576000366003190112610175576020600080516020611d8b8339815191525460501c6040519060018060a01b03168152f35b6001600160a01b0381160361017557565b359061020c826102fa565b9181601f84011215610175578235916001600160401b038311610175576020838186019501011161017557565b346101755760803660031901126101755761035f6004356102fa565b61036a6024356102fa565b6064356001600160401b03811161017557610389903690600401610316565b5050604051630a85bd0160e11b8152602090f35b34610175576040366003190112610175576024356001600160401b038111610175576103db6103d26020923690600401610316565b906004356119e5565b6040516001600160e01b03199091168152f35b600435906001600160e01b03198216820361017557565b65ffffffffffff81160361017557565b60c0366003190112610175576104296103ee565b60243590610436826102fa565b60443590610443826102fa565b60643561044f81610405565b6084359361045c85610405565b60a4356001600160401b0381116101755761047b903690600401610316565b9590946001600160a01b0393337f0000000000000000000000000000000000000000000000000000000000000000861614158061061e575b61060c5784926104e861057f926104d96104cb6101ff565b65ffffffffffff9094168452565b65ffffffffffff166020830152565b6001600160a01b03851660408201526001600160a01b038316606082015261050f87611048565b81516020830151604084015160309190911b6bffffffffffff0000000000001665ffffffffffff9290921691909117606091821b6bffffffffffffffffffffffff19161782559091015160019190910180546001600160a01b0319166001600160a01b0392909216919091179055565b1693843b15610175576040519063064acaab60e11b825281806105a96000998a94600484016115e5565b038183895af18015610607576105ee575b5016906001600160e01b0319167fed03d2572564284398470d3f266a693e29ddfff3eba45fc06c5e91013d3213538480a480f35b806105fb61060192610190565b8061016a565b386105ba565b6112cd565b604051637046c88d60e01b8152600490fd5b50303314156104b3565b602036600319011261017557600435610640816102fa565b6001600160a01b0390337f000000000000000000000000000000000000000000000000000000000000000083161415806106c4575b61060c57807f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc55167fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b600080a2005b5030331415610675565b9291926001600160401b0382116101a357604051916106f7601f8201601f1916602001846101de565b829481845281830111610175578281602093846000960137010152565b9080601f830112156101755781602061072f933591016106ce565b90565b6003196060368201126101755760048035916001600160401b0390818411610175576101609084360301126101755761076961020e565b9061077584840161030b565b82526024840135602083015260448401358181116101755761079c90843691870101610714565b60408301526064840135818111610175576107bc90843691870101610714565b60608301526084840135608083015260a484013560a083015260c484013560c083015260e484013560e08301526101048401356101008301526101248401358181116101755761081190843691870101610714565b610120830152610144840135908111610175576102c09361084c936108399236920101610714565b61014082015260443590602435906112d9565b6040519081529081906020820190565b34610175576020366003190112610175576004356001600160c01b0381169081900361017557604051631aab3f0d60e11b815230600482015260248101919091526020816044817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa8015610607576102c0916000916108f2575b506040519081529081906020820190565b610913915060203d8111610919575b61090b81836101de565b8101906111ee565b386108e1565b503d610901565b34610175576020366003190112610175576102c061096561093f6103ee565b6000606060405161094f816101a8565b8281528260208201528260408201520152611048565b60405190610972826101a8565b805465ffffffffffff80821684528160301c16602084015260601c60408301526001808060a01b03910154166060820152604051918291829190916060608082019365ffffffffffff80825116845260208201511660208401528160018060a01b0391826040820151166040860152015116910152565b608036600319011261017557600435610a01816102fa565b6044356001600160401b03811161017557610a20903690600401610714565b90606435600281101561017557337f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316141580610ab3575b61060c57610a6d816110f9565b610a96576000828193926020839451920190602435905af13d82803e15610a92573d90f35b3d90fd5b60008281939260208394519201905af43d82803e15610a92573d90f35b50610ac3610abf611b18565b1590565b610a60565b60405190610ad5826101c3565b6005825264302e322e3160d81b6020830152565b34610175576000366003190112610175576102c06102ac610ac8565b90604060031983011261017557600435610b1e816102fa565b91602435906001600160401b03821161017557610b3d91600401610316565b9091565b610b4a36610b05565b90916001600160a01b03337f00000000000000000000000000000000000000000000000000000000000000008216141580610c1d575b61060c5780600080516020611d8b8339815191525460501c1691610ba381611cae565b1692836040519360009586947fa35f5cdc5fbabb614b4cd5064ce5543f43dc8fab0e4da41255230eb8aba2531c8680a3813b15610c19578385610bf7819593829463064acaab60e11b8452600484016115e5565b03925af1801561060757610c09575080f35b806105fb610c1692610190565b80f35b8380fd5b5030331415610b80565b34610175576000366003190112610175576020600080516020611d8b8339815191525460e01b6040519063ffffffff60e01b168152f35b3461017557600036600319011261017557610cb4610c7a61022e565b610c82610ac8565b90604051928392600f60f81b8452610ca660209360e08587015260e0860190610250565b908482036040860152610250565b90466060840152306080840152600060a084015282820360c08401528060605192838152019160809160005b828110610cef57505050500390f35b835185528695509381019392810192600101610ce0565b34610175576000366003190112610175576020600080516020611d8b8339815191525465ffffffffffff60405191831c168152f35b34610175576000366003190112610175576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b9181601f84011215610175578235916001600160401b038311610175576020808501948460051b01011161017557565b346101755760a036600319011261017557610dcc6004356102fa565b610dd76024356102fa565b6001600160401b0360443581811161017557610df7903690600401610d80565b505060643581811161017557610e11903690600401610d80565b505060843590811161017557610e2b903690600401610316565b505060405163bc197c8160e01b8152602090f35b3461017557600036600319011261017557604051631aab3f0d60e11b8152306004820152600060248201526020816044817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa8015610607576102c0916000916108f257506040519081529081906020820190565b610ec736610b05565b600080516020611d8b83398151915254919290916001600160a01b03919060501c8216610f4b57610ef781611cae565b1691823b1561017557610f2c926000928360405180968195829463064acaab60e11b8452602060048501526024840191611581565b03925af1801561060757610f3c57005b806105fb610f4992610190565b005b60405162dc149f60e41b8152600490fd5b602036600319011261017557610f706103ee565b337f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316141580610fe4575b61060c57600080516020611d8b83398151915290815469ffffffffffff000000004260201b169160e01c9069ffffffffffffffffffff191617179055600080f35b5030331415610fa3565b346101755760a03660031901126101755761100a6004356102fa565b6110156024356102fa565b6084356001600160401b03811161017557611034903690600401610316565b505060405163f23a6e6160e01b8152602090f35b63ffffffff60e01b166000527f439ffe7df606b78489639bc0b827913bd09e1246fa6802968a5b3694c53e0dda602052604060002090565b600061109681356001600160e01b031916611048565b5460601c337f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03161415806110ea575b61060c57818091368280378136915af43d82803e15610a92573d90f35b506110f3611b18565b156110cd565b6002111561110357565b634e487b7160e01b600052602160045260246000fd5b906004116101755790600490565b909291928360041161017557831161017557600401916003190190565b906024116101755760100190601490565b906058116101755760380190602090565b906024116101755760040190602090565b906038116101755760240190601490565b90600a116101755760040190600690565b9060101161017557600a0190600690565b90939293848311610175578411610175578101920390565b6001600160e01b031990358181169392600481106111df57505050565b60040360031b82901b16169150565b90816020910312610175575190565b606080825282516001600160a01b031690820152919392916040916112c3906020810151608084015283810151611242610160918260a08701526101c0860190610250565b906112b0611262606085015193605f1994858983030160c08a0152610250565b608085015160e088015260a085015192610100938489015260c08601519061012091828a015260e08701519461014095868b0152870151908901528501518488830301610180890152610250565b92015190848303016101a0850152610250565b9460208201520152565b6040513d6000823e3d90fd5b6001600160a01b03939260009290918391907f000000000000000000000000000000000000000000000000000000000000000087163303611521576004908135978861014481013501928060248501940135600080516020611d8b833981519152549461134f6113498383611119565b906111c2565b9b6001600160e01b0319808e16908161140457505050899a9b5061137e826020999a9b95949361139593611127565b9660501c965b858c806113f5575b505036916106ce565b6101408501526113b9604051998a9788968794633a871cdd60e01b865285016111fd565b0393165af19182156106075761072f93926113d5575b50611d24565b6113ee91925060203d81116109195761090b81836101de565b90386113cf565b81808092335af150858c61138c565b9199509197969594939c8660e01b1616151560001461142e5760405163fc2f51c560e01b81528c90fd5b90899a9b91600160e09b95969798999a9b1b81146000146114cd575061146f61146a6113498b606460209c9d0135016024868201359101611119565b611048565b60018101549099906001600160a01b031696848816156114c2575b50816113959261149992611127565b995460d081901b6001600160d01b03191660709190911b65ffffffffffff60a01b161799611384565b60501c96508161148a565b9198979095509250600160e11b0361151357611509611395948a936115046113498a606460209c01350160248d8201359101611119565b6115f6565b9199929691611384565b505050505050505050600190565b604051636b31ba1560e11b8152600490fd5b6bffffffffffffffffffffffff19903581811693926014811061155557505050565b60140360031b82901b16169150565b359060208110611572575090565b6000199060200360031b1b1690565b908060209392818452848401376000828201840152601f01601f1916010190565b60409061072f949281528160208201520191611581565b6001600160d01b031990358181169392600681106115d657505050565b60060360031b82901b16169150565b91602061072f938181520191611581565b9061162261161661161061160a8685611144565b90611533565b60601c90565b6001600160a01b031690565b936116366116308584611155565b90611564565b60588301607882019461165161163087856058018a896111aa565b9661175a6116626116308389611166565b61167261161061160a858b611177565b996117006116813689896106ce565b8051602091820120604080517f3ce406685c1b3551d706d85a68afdaa49ac4e07b451ad9b8ff8b58c3ee9641768185019081526001600160e01b03198b169282019290925260608101969096526001600160a01b039e909e16608086015260a08086019190915284529b8c936116f860c0826101de565b5190206118d1565b600080516020611d8b8339815191525490919061173c9061172c9060501c6001600160a01b0316611616565b9189019b60788d0190878d6111aa565b60405163199ed7c960e11b81529586948593849391600485016115a2565b03915afa9283156106075761146a6117a06118609561050f946000916118b4575b50611799611789878d611166565b6001600160a01b03199291611564565b1690611d24565b9a898b016078019a85036077190199611850906118406117e06117d56117cf6117c98b86611188565b906115b9565b60d01c90565b65ffffffffffff1690565b9761181761161661161061160a6118006117d56117cf6117c9888b611199565b9461181161161061160a838b611177565b97611144565b946118316118236101ff565b65ffffffffffff909b168b52565b89019065ffffffffffff169052565b6001600160a01b03166040870152565b6001600160a01b03166060850152565b6001600160a01b03871691823b1561017557611896926000928360405180968195829463064acaab60e11b8452600484016115e5565b03925af18015610607576118a75750565b806105fb61020c92610190565b6118cb91508d803d106109195761090b81836101de565b3861177b565b7f00000000000000000000000000000000000000000000000000000000000000007f000000000000000000000000000000000000000000000000000000000000000030147f00000000000000000000000000000000000000000000000000000000000000004614161561195e575b671901000000000000600052601a52603a526042601820906000603a52565b5060a06040517f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f81527f000000000000000000000000000000000000000000000000000000000000000060208201527f000000000000000000000000000000000000000000000000000000000000000060408201524660608201523060808201522061193f565b600080516020611d8b83398151915254611a3293602093909291611a149060501c6001600160a01b0316611616565b916040519586948593849363199ed7c960e11b8552600485016115a2565b03915afa801561060757611a4e91600091611aa9575b50611cfb565b9165ffffffffffff908142911611611a995742911610611a8c576001600160a01b0316611a8057630b135d3f60e11b90565b6001600160e01b031990565b506001600160e01b031990565b506001600160e01b031992915050565b611ac1915060203d81116109195761090b81836101de565b38611a48565b90816020910312610175575180151581036101755790565b6001600160a01b0390911681526040602082018190528101829052606091806000848401376000828201840152601f01601f1916010190565b600080516020611d8b83398151915254611b3d9060501c6001600160a01b0316611616565b6040519081639ea9bd5960e01b9182825260209384918180611b63363360048401611adf565b03915afa90811561060757600091611c91575b50611c8a57611b906000356001600160e01b031916611048565b6001810154909190611baa906001600160a01b0316611616565b916001600160a01b03831615908115611c4e575b8115611c2a575b5015611bd357505050600090565b829060405192839182528180611bed363360048401611adf565b03915afa91821561060757600092611c0457505090565b61072f9250803d10611c23575b611c1b81836101de565b810190611ac7565b503d611c11565b54611c3d915065ffffffffffff166117d5565b65ffffffffffff4291161138611bc5565b905065ffffffffffff611c6e6117d5835465ffffffffffff9060301c1690565b168015159081611c80575b5090611bbe565b9050421138611c79565b5050600190565b611ca89150833d8511611c2357611c1b81836101de565b38611b76565b600080516020611d8b83398151915280547fffff0000000000000000000000000000000000000000ffffffffffffffffffff1660509290921b600160501b600160f01b0316919091179055565b8065ffffffffffff91828160a01c16928315600114611d1c575b5060d01c92565b925038611d15565b8082186001600160a01b031615600114611d3f575050600190565b65ffffffffffff60a01b828116828216818118918111919091028082189465ffffffffffff60a01b199485169416929114611d82575b5081811190821802181790565b925038611d7556fe439ffe7df606b78489639bc0b827913bd09e1246fa6802968a5b3694c53e0dd9";

bytes constant KERNEL_FACTORY =
    hex"6080346100b257601f610b2d38819003918201601f19168301916001600160401b038311848410176100b75780849260409485528339810103126100b25780516001600160a01b0391828216918290036100b257602001519182168092036100b25780638b78c6d8195560007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a3600080546001600160a01b031916919091179055604051610a5f90816100ce8239f35b600080fd5b634e487b7160e01b600052604160045260246000fdfe6040608081526004908136101561001557600080fd5b600091823560e01c9081630396cb60146107d45781632569296214610789578163296601cd1461059d5781634d6cb7001461052b5781635414dff0146104fa57816354d1f13d146104b4578163584465f2146104745781636544c82814610436578163715018a6146103f05781638da5cb5b146103c3578163b0d691fe1461039b578163bb30a9741461034557838263bb9fe6bf146102ec578263c23a5cea1461026157508163d7533f0214610243578163db4c545e14610219578163f04e283e14610199578163f2fde38b1461012c575063fee81cf4146100f657600080fd5b3461012857602036600319011261012857602091610112610845565b9063389a75e1600c525281600c20549051908152f35b5080fd5b8390602036600319011261012857610142610845565b9061014b61088e565b8160601b1561018e575060018060a01b0316638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08580a35580f35b637448fbae8352601cfd5b83906020366003190112610128576101af610845565b906101b861088e565b63389a75e1600c528183526020600c20908154421161020e575082905560018060a01b0316638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08580a35580f35b636f5e88188452601cfd5b5050346101285781600319360112610128576020906089601361023a6108d8565b01209051908152f35b505034610128578160031936011261012857602090516202a3008152f35b809184346102e85760203660031901126102e85781356001600160a01b0381811693918490036102e45761029361088e565b84541692833b156102e45760248592838551968794859363611d2e7560e11b85528401525af19081156102db57506102c85750f35b6102d190610a13565b6102d85780f35b80fd5b513d84823e3d90fd5b8480fd5b5050fd5b809184346102e857826003193601126102e85761030761088e565b82546001600160a01b031691823b1561034057815163bb9fe6bf60e01b81529284918491829084905af19081156102db57506102c85750f35b505050fd5b50503461012857806003193601126101285761035f610845565b90602435918215158093036103975761037661088e565b60018060a01b03168352600160205282209060ff8019835416911617905580f35b8380fd5b505034610128578160031936011261012857905490516001600160a01b039091168152602090f35b505034610128578160031936011261012857638b78c6d8195490516001600160a01b039091168152602090f35b83806003193601126102d85761040461088e565b80638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a35580f35b5050346101285760203660031901126101285760209160ff9082906001600160a01b03610461610845565b1681526001855220541690519015158152f35b83903461012857602036600319011261012857356001600160a01b03811690819003610128576104a261088e565b81546001600160a01b03191617815580f35b83806003193601126102d85763389a75e1600c52338152806020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c928280a280f35b8284346102d85760203660031901126102d8575061051a602092356108ab565b90516001600160a01b039091168152f35b8284346102d857816003193601126102d85782359067ffffffffffffffff82116102d857506bffffffffffffffffffffffff61056f60209461051a93369101610860565b6105948580518381948a830196873781016024358a8201520388810184520182610a3d565b519020166108ab565b828460603660031901126102d8576105b3610845565b9160243567ffffffffffffffff8111610785576105d39036908601610860565b9360018060a01b039384821681526020966001885260ff858320541615610730576bffffffffffffffffffffffff8551898101908987833761062988828d8d82019060443590820152038d810184520182610a3d565b5190201696331560011715610724576106406108d8565b90601382019860898a2060ff86536035523060601b600152806015526055852099856035528a3b15610678575b8b8b8b8b5191168152f35b856089929394959697989b50f597881561071857918185939284938884527f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc8d85015289840137870190348a5af1156106fe57507f09e48df7857bd0c1e0d31bb8a85d42cf1874817895f171c917f6ee2cea73ec20818692a3848080808080808061066d565b3d1561070d57503d81803e3d90fd5b63301164258252601cfd5b8363301164258652601cfd5b50632f6348368252601cfd5b845162461bcd60e51b8152908101889052602960248201527f4b65726e656c466163746f72793a20696d706c656d656e746174696f6e206e6f6044820152681d08185b1b1bddd95960ba1b6064820152608490fd5b8280fd5b83806003193601126102d85763389a75e1600c523381526202a30042016020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d8280a280f35b91905060203660031901126107855782823563ffffffff8116809103610128576107fc61088e565b81546001600160a01b031693843b156107855760249084519586938492621cb65b60e51b845283015234905af19081156102db5750610839575080f35b61084290610a13565b80f35b600435906001600160a01b038216820361085b57565b600080fd5b9181601f8401121561085b5782359167ffffffffffffffff831161085b576020838186019501011161085b57565b638b78c6d81954330361089d57565b6382b429006000526004601cfd5b608960136108b76108d8565b012060ff6000536035523060601b6001526015526055600020906000603552565b604051903060701c1561097c57666052573d6000fd607b8301527f3d356020355560408036111560525736038060403d373d3d355af43d6000803e60748301527f3735a920a3ca505d382bbc545af43d6000803e6052573d6000fd5b3d6000f35b60548301527f14605757363d3d37363d7f360894a13ba1a3210667c828492db98dca3e2076cc60348301523060148301526c607f3d8160093d39f33d3d33738252565b66604c573d6000fd60758301527f3d3560203555604080361115604c5736038060403d373d3d355af43d6000803e606e8301527f3735a920a3ca505d382bbc545af43d6000803e604c573d6000fd5b3d6000f35b604e8301527f14605157363d3d37363d7f360894a13ba1a3210667c828492db98dca3e2076cc602e83015230600e8301526c60793d8160093d39f33d3d336d8252565b67ffffffffffffffff8111610a2757604052565b634e487b7160e01b600052604160045260246000fd5b90601f8019910116810190811067ffffffffffffffff821117610a275760405256";

bytes constant KERNEL_FACTORY_BYTECODE =
    hex"6080346100b257601f610b2d38819003918201601f19168301916001600160401b038311848410176100b75780849260409485528339810103126100b25780516001600160a01b0391828216918290036100b257602001519182168092036100b25780638b78c6d8195560007f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08180a3600080546001600160a01b031916919091179055604051610a5f90816100ce8239f35b600080fd5b634e487b7160e01b600052604160045260246000fdfe6040608081526004908136101561001557600080fd5b600091823560e01c9081630396cb60146107d45781632569296214610789578163296601cd1461059d5781634d6cb7001461052b5781635414dff0146104fa57816354d1f13d146104b4578163584465f2146104745781636544c82814610436578163715018a6146103f05781638da5cb5b146103c3578163b0d691fe1461039b578163bb30a9741461034557838263bb9fe6bf146102ec578263c23a5cea1461026157508163d7533f0214610243578163db4c545e14610219578163f04e283e14610199578163f2fde38b1461012c575063fee81cf4146100f657600080fd5b3461012857602036600319011261012857602091610112610845565b9063389a75e1600c525281600c20549051908152f35b5080fd5b8390602036600319011261012857610142610845565b9061014b61088e565b8160601b1561018e575060018060a01b0316638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08580a35580f35b637448fbae8352601cfd5b83906020366003190112610128576101af610845565b906101b861088e565b63389a75e1600c528183526020600c20908154421161020e575082905560018060a01b0316638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08580a35580f35b636f5e88188452601cfd5b5050346101285781600319360112610128576020906089601361023a6108d8565b01209051908152f35b505034610128578160031936011261012857602090516202a3008152f35b809184346102e85760203660031901126102e85781356001600160a01b0381811693918490036102e45761029361088e565b84541692833b156102e45760248592838551968794859363611d2e7560e11b85528401525af19081156102db57506102c85750f35b6102d190610a13565b6102d85780f35b80fd5b513d84823e3d90fd5b8480fd5b5050fd5b809184346102e857826003193601126102e85761030761088e565b82546001600160a01b031691823b1561034057815163bb9fe6bf60e01b81529284918491829084905af19081156102db57506102c85750f35b505050fd5b50503461012857806003193601126101285761035f610845565b90602435918215158093036103975761037661088e565b60018060a01b03168352600160205282209060ff8019835416911617905580f35b8380fd5b505034610128578160031936011261012857905490516001600160a01b039091168152602090f35b505034610128578160031936011261012857638b78c6d8195490516001600160a01b039091168152602090f35b83806003193601126102d85761040461088e565b80638b78c6d8198181547f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a35580f35b5050346101285760203660031901126101285760209160ff9082906001600160a01b03610461610845565b1681526001855220541690519015158152f35b83903461012857602036600319011261012857356001600160a01b03811690819003610128576104a261088e565b81546001600160a01b03191617815580f35b83806003193601126102d85763389a75e1600c52338152806020600c2055337ffa7b8eab7da67f412cc9575ed43464468f9bfbae89d1675917346ca6d8fe3c928280a280f35b8284346102d85760203660031901126102d8575061051a602092356108ab565b90516001600160a01b039091168152f35b8284346102d857816003193601126102d85782359067ffffffffffffffff82116102d857506bffffffffffffffffffffffff61056f60209461051a93369101610860565b6105948580518381948a830196873781016024358a8201520388810184520182610a3d565b519020166108ab565b828460603660031901126102d8576105b3610845565b9160243567ffffffffffffffff8111610785576105d39036908601610860565b9360018060a01b039384821681526020966001885260ff858320541615610730576bffffffffffffffffffffffff8551898101908987833761062988828d8d82019060443590820152038d810184520182610a3d565b5190201696331560011715610724576106406108d8565b90601382019860898a2060ff86536035523060601b600152806015526055852099856035528a3b15610678575b8b8b8b8b5191168152f35b856089929394959697989b50f597881561071857918185939284938884527f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc8d85015289840137870190348a5af1156106fe57507f09e48df7857bd0c1e0d31bb8a85d42cf1874817895f171c917f6ee2cea73ec20818692a3848080808080808061066d565b3d1561070d57503d81803e3d90fd5b63301164258252601cfd5b8363301164258652601cfd5b50632f6348368252601cfd5b845162461bcd60e51b8152908101889052602960248201527f4b65726e656c466163746f72793a20696d706c656d656e746174696f6e206e6f6044820152681d08185b1b1bddd95960ba1b6064820152608490fd5b8280fd5b83806003193601126102d85763389a75e1600c523381526202a30042016020600c2055337fdbf36a107da19e49527a7176a1babf963b4b0ff8cde35ee35d6cd8f1f9ac7e1d8280a280f35b91905060203660031901126107855782823563ffffffff8116809103610128576107fc61088e565b81546001600160a01b031693843b156107855760249084519586938492621cb65b60e51b845283015234905af19081156102db5750610839575080f35b61084290610a13565b80f35b600435906001600160a01b038216820361085b57565b600080fd5b9181601f8401121561085b5782359167ffffffffffffffff831161085b576020838186019501011161085b57565b638b78c6d81954330361089d57565b6382b429006000526004601cfd5b608960136108b76108d8565b012060ff6000536035523060601b6001526015526055600020906000603552565b604051903060701c1561097c57666052573d6000fd607b8301527f3d356020355560408036111560525736038060403d373d3d355af43d6000803e60748301527f3735a920a3ca505d382bbc545af43d6000803e6052573d6000fd5b3d6000f35b60548301527f14605757363d3d37363d7f360894a13ba1a3210667c828492db98dca3e2076cc60348301523060148301526c607f3d8160093d39f33d3d33738252565b66604c573d6000fd60758301527f3d3560203555604080361115604c5736038060403d373d3d355af43d6000803e606e8301527f3735a920a3ca505d382bbc545af43d6000803e604c573d6000fd5b3d6000f35b604e8301527f14605157363d3d37363d7f360894a13ba1a3210667c828492db98dca3e2076cc602e83015230600e8301526c60793d8160093d39f33d3d336d8252565b67ffffffffffffffff8111610a2757604052565b634e487b7160e01b600052604160045260246000fd5b90601f8019910116810190811067ffffffffffffffff821117610a275760405256";

function deployAccountFactory(
    address owner,
    address entrypoint
)
    returns (IKernelFactory kernelFactory)
{
    bytes memory args = abi.encode(owner, entrypoint);
    bytes memory factorySingletonBytecode = abi.encodePacked(KERNEL_FACTORY_BYTECODE, args);
    address _kernelFactory;
    assembly {
        _kernelFactory :=
            create(0, add(factorySingletonBytecode, 0x20), mload(factorySingletonBytecode))
    }
    kernelFactory = IKernelFactory(_kernelFactory);
}
